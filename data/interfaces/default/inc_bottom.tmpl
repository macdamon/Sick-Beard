#import sickbeard
#import datetime
#from sickbeard import db
#from sickbeard.common import *
    </div> <!-- /content -->
</div> <!-- /contentWrapper -->

<footer>
    <div class="container footer">

        #set $myDB = $db.DBConnection()
        #set $today = str($datetime.date.today().toordinal())
        #set status_quality = '(' + ','.join([str(x) for x in $Quality.SNATCHED + $Quality.SNATCHED_PROPER]) + ')'
        #set status_download = '(' + ','.join([str(x) for x in $Quality.DOWNLOADED + [$ARCHIVED]]) + ')'

        #set $sql_statement = 'SELECT '

        #set $sql_statement += '(SELECT COUNT(*) FROM tv_episodes WHERE season != 0 AND episode != 0 AND airdate != 1 AND status IN ' + $status_quality + ') AS snatched, '
        #set $sql_statement += '(SELECT COUNT(*) FROM tv_episodes WHERE season != 0 AND episode != 0 AND airdate != 1 AND status IN ' + $status_download + ') AS downloaded, '

        #set $sql_statement += '(SELECT COUNT(*) FROM tv_episodes WHERE season != 0 AND episode != 0 AND airdate != 1 '
        #set $sql_statement += ' AND ((airdate <= ' + $today + ' AND status != ' + str($IGNORED) + ') OR (airdate > '+ $today + ' AND status IN ' + status_quality + ') '
        #set $sql_statement += ' OR (airdate > ' + $today + ' AND status IN '+ status_download + '))) AS count_total_down '

        #set $sql_statement += ' FROM tv_episodes tv_eps LIMIT 1'

        #set $sql_result = $myDB.select($sql_statement)

        #set $numShows = len($sickbeard.showList)
        #set $numGoodShows = len([x for x in $sickbeard.showList if x.paused == 0 and x.status != "Ended"])

        #if $sql_result:
            #set $numSNAEpisodes = $sql_result[0]['snatched']
            #set $numDNLEpisodes = $sql_result[0]['downloaded']
            #set $numALLEpisodes = $sql_result[0]['count_total_down']
        #else
            #set $numSNAEpisodes = 0
            #set $numDNLEpisodes = 0
            #set $numALLEpisodes = 0
        #end if

        <b>$numShows shows</b> ($numGoodShows active) | <b><%=numDNLEpisodes + numSNAEpisodes%></b>#if $numSNAEpisodes > 0 then " (" + str($numSNAEpisodes) + " snatched)" else ""#<b> / $numALLEpisodes</b> episodes downloaded
        <br />
        <b>Search</b>: <%=str(sickbeard.currentSearchScheduler.timeLeft()).split('.')[0]%> |
        <b>Backlog</b>: $sickbeard.backlogSearchScheduler.nextRun().strftime("%a %b %d").decode($sickbeard.SYS_ENCODING)
    </div> <!-- /container footer -->
</footer>
</body>
</html>
